{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/context_menu/ui.menu_base.js)\r\n * Version: 22.2.6\r\n * Build date: Tue Apr 18 2023\r\n *\r\n * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../../core/renderer\";\nimport { noop, asyncNoop } from \"../../core/utils/common\";\nimport { isPlainObject, isObject, isDefined } from \"../../core/utils/type\";\nimport { each } from \"../../core/utils/iterator\";\nimport { extend } from \"../../core/utils/extend\";\nimport { render } from \"../widget/utils.ink_ripple\";\nimport HierarchicalCollectionWidget from \"../hierarchical_collection/ui.hierarchical_collection_widget\";\nimport MenuBaseEditStrategy from \"./ui.menu_base.edit.strategy\";\nimport devices from \"../../core/devices\";\nimport MenuItem from \"../collection/item\";\nvar DX_MENU_CLASS = \"dx-menu\";\nvar DX_MENU_NO_ICONS_CLASS = DX_MENU_CLASS + \"-no-icons\";\nvar DX_MENU_BASE_CLASS = \"dx-menu-base\";\nvar ITEM_CLASS = DX_MENU_CLASS + \"-item\";\nvar DX_ITEM_CONTENT_CLASS = ITEM_CLASS + \"-content\";\nvar DX_MENU_SELECTED_ITEM_CLASS = ITEM_CLASS + \"-selected\";\nvar DX_MENU_ITEM_WRAPPER_CLASS = ITEM_CLASS + \"-wrapper\";\nvar DX_MENU_ITEMS_CONTAINER_CLASS = DX_MENU_CLASS + \"-items-container\";\nvar DX_MENU_ITEM_EXPANDED_CLASS = ITEM_CLASS + \"-expanded\";\nvar DX_MENU_SEPARATOR_CLASS = DX_MENU_CLASS + \"-separator\";\nvar DX_MENU_ITEM_LAST_GROUP_ITEM = DX_MENU_CLASS + \"-last-group-item\";\nvar DX_ITEM_HAS_TEXT = ITEM_CLASS + \"-has-text\";\nvar DX_ITEM_HAS_ICON = ITEM_CLASS + \"-has-icon\";\nvar DX_ITEM_HAS_SUBMENU = ITEM_CLASS + \"-has-submenu\";\nvar DX_MENU_ITEM_POPOUT_CLASS = ITEM_CLASS + \"-popout\";\nvar DX_MENU_ITEM_POPOUT_CONTAINER_CLASS = DX_MENU_ITEM_POPOUT_CLASS + \"-container\";\nvar DX_MENU_ITEM_CAPTION_CLASS = ITEM_CLASS + \"-text\";\nvar SINGLE_SELECTION_MODE = \"single\";\nvar DEFAULT_DELAY = {\n  show: 50,\n  hide: 300\n};\nclass MenuBase extends HierarchicalCollectionWidget {\n  _getDefaultOptions() {\n    return extend(super._getDefaultOptions(), {\n      items: [],\n      cssClass: \"\",\n      activeStateEnabled: true,\n      showSubmenuMode: {\n        name: \"onHover\",\n        delay: {\n          show: 50,\n          hide: 300\n        }\n      },\n      animation: {\n        show: {\n          type: \"fade\",\n          from: 0,\n          to: 1,\n          duration: 100\n        },\n        hide: {\n          type: \"fade\",\n          from: 1,\n          to: 0,\n          duration: 100\n        }\n      },\n      selectByClick: false,\n      focusOnSelectedItem: false,\n      keyExpr: null,\n      _itemAttributes: {\n        role: \"menuitem\"\n      },\n      useInkRipple: false\n    });\n  }\n  _itemDataKey() {\n    return \"dxMenuItemDataKey\";\n  }\n  _itemClass() {\n    return ITEM_CLASS;\n  }\n  _setAriaSelected() {}\n  _selectedItemClass() {\n    return DX_MENU_SELECTED_ITEM_CLASS;\n  }\n  _widgetClass() {\n    return DX_MENU_BASE_CLASS;\n  }\n  _focusTarget() {\n    return this._itemContainer();\n  }\n  _clean() {\n    this.option(\"focusedElement\", null);\n    super._clean();\n  }\n  _supportedKeys() {\n    return extend(super._supportedKeys(), {\n      space: () => {\n        var $item = $(this.option(\"focusedElement\"));\n        if (!$item.length || !this._isSelectionEnabled()) {\n          return;\n        }\n        this.selectItem($item[0]);\n      },\n      pageUp: noop,\n      pageDown: noop\n    });\n  }\n  _isSelectionEnabled() {\n    return this.option(\"selectionMode\") === SINGLE_SELECTION_MODE;\n  }\n  _init() {\n    this._activeStateUnit = \".\".concat(ITEM_CLASS);\n    super._init();\n    this._renderSelectedItem();\n    this._initActions();\n  }\n  _getTextContainer(itemData) {\n    var itemText = itemData.text;\n    var $itemContainer = $(\"<span>\").addClass(DX_MENU_ITEM_CAPTION_CLASS);\n    var itemContent = isPlainObject(itemData) ? itemText : String(itemData);\n    return itemText && $itemContainer.text(itemContent);\n  }\n  _getPopoutContainer(itemData) {\n    var items = itemData.items;\n    var $popOutContainer;\n    if (items && items.length) {\n      var $popOutImage = $(\"<div>\").addClass(DX_MENU_ITEM_POPOUT_CLASS);\n      $popOutContainer = $(\"<span>\").addClass(DX_MENU_ITEM_POPOUT_CONTAINER_CLASS).append($popOutImage);\n    }\n    return $popOutContainer;\n  }\n  _getDataAdapterOptions() {\n    return {\n      rootValue: 0,\n      multipleSelection: false,\n      recursiveSelection: false,\n      recursiveExpansion: false,\n      searchValue: \"\"\n    };\n  }\n  _selectByItem(selectedItem) {\n    if (!selectedItem) {\n      return;\n    }\n    var nodeToSelect = this._dataAdapter.getNodeByItem(selectedItem);\n    this._dataAdapter.toggleSelection(nodeToSelect.internalFields.key, true);\n  }\n  _renderSelectedItem() {\n    var selectedKeys = this._dataAdapter.getSelectedNodesKeys();\n    var selectedKey = selectedKeys.length && selectedKeys[0];\n    var selectedItem = this.option(\"selectedItem\");\n    if (!selectedKey) {\n      this._selectByItem(selectedItem);\n      return;\n    }\n    var node = this._dataAdapter.getNodeByKey(selectedKey);\n    if (false === node.selectable) {\n      return;\n    }\n    if (!selectedItem) {\n      this.option(\"selectedItem\", node.internalFields.item);\n      return;\n    }\n    if (selectedItem !== node.internalFields.item) {\n      this._dataAdapter.toggleSelection(selectedKey, false);\n      this._selectByItem(selectedItem);\n    }\n  }\n  _initActions() {}\n  _initMarkup() {\n    super._initMarkup();\n    this.option(\"useInkRipple\") && this._renderInkRipple();\n  }\n  _renderInkRipple() {\n    this._inkRipple = render();\n  }\n  _toggleActiveState($element, value, e) {\n    super._toggleActiveState.apply(this, arguments);\n    if (!this._inkRipple) {\n      return;\n    }\n    var config = {\n      element: $element,\n      event: e\n    };\n    if (value) {\n      this._inkRipple.showWave(config);\n    } else {\n      this._inkRipple.hideWave(config);\n    }\n  }\n  _getShowSubmenuMode() {\n    var optionValue = this.option(\"showSubmenuMode\");\n    optionValue = isObject(optionValue) ? optionValue.name : optionValue;\n    return this._isDesktopDevice() ? optionValue : \"onClick\";\n  }\n  _initSelectedItems() {}\n  _isDesktopDevice() {\n    return \"desktop\" === devices.real().deviceType;\n  }\n  _initEditStrategy() {\n    var Strategy = MenuBaseEditStrategy;\n    this._editStrategy = new Strategy(this);\n  }\n  _addCustomCssClass($element) {\n    $element.addClass(this.option(\"cssClass\"));\n  }\n  _itemWrapperSelector() {\n    return \".\".concat(DX_MENU_ITEM_WRAPPER_CLASS);\n  }\n  _hoverStartHandler(e) {\n    var $itemElement = this._getItemElementByEventArgs(e);\n    if (!$itemElement || this._isItemDisabled($itemElement)) {\n      return;\n    }\n    e.stopPropagation();\n    if (\"onHover\" === this._getShowSubmenuMode()) {\n      clearTimeout(this._showSubmenusTimeout);\n      this._showSubmenusTimeout = setTimeout(this._showSubmenu.bind(this, $itemElement), this._getSubmenuDelay(\"show\"));\n    }\n  }\n  _getAvailableItems($itemElements) {\n    return super._getAvailableItems($itemElements).filter(function () {\n      return \"hidden\" !== $(this).css(\"visibility\");\n    });\n  }\n  _isItemDisabled($item) {\n    return this._disabledGetter($item.data(this._itemDataKey()));\n  }\n  _showSubmenu($itemElement) {\n    this._addExpandedClass($itemElement);\n  }\n  _addExpandedClass(itemElement) {\n    $(itemElement).addClass(DX_MENU_ITEM_EXPANDED_CLASS);\n  }\n  _getSubmenuDelay(action) {\n    var {\n      delay: delay\n    } = this.option(\"showSubmenuMode\");\n    if (!isDefined(delay)) {\n      return DEFAULT_DELAY[action];\n    }\n    return isObject(delay) ? delay[action] : delay;\n  }\n  _getItemElementByEventArgs(eventArgs) {\n    var $target = $(eventArgs.target);\n    if ($target.hasClass(this._itemClass()) || $target.get(0) === eventArgs.currentTarget) {\n      return $target;\n    }\n    while (!$target.hasClass(this._itemClass())) {\n      $target = $target.parent();\n      if ($target.hasClass(\"dx-submenu\")) {\n        return null;\n      }\n    }\n    return $target;\n  }\n  _hoverEndHandler() {\n    clearTimeout(this._showSubmenusTimeout);\n  }\n  _hasSubmenu(node) {\n    return node && node.internalFields.childrenKeys.length;\n  }\n  _renderContentImpl() {\n    this._renderItems(this._dataAdapter.getRootNodes());\n  }\n  _renderItems(nodes, submenuContainer) {\n    if (nodes.length) {\n      this.hasIcons = false;\n      var $nodeContainer = this._renderContainer(this.$element(), submenuContainer);\n      var firstVisibleIndex = -1;\n      var nextGroupFirstIndex = -1;\n      each(nodes, (index, node) => {\n        var isVisibleNode = false !== node.visible;\n        if (isVisibleNode && firstVisibleIndex < 0) {\n          firstVisibleIndex = index;\n        }\n        var isBeginGroup = firstVisibleIndex < index && (node.beginGroup || index === nextGroupFirstIndex);\n        if (isBeginGroup) {\n          nextGroupFirstIndex = isVisibleNode ? index : index + 1;\n        }\n        if (index === nextGroupFirstIndex && firstVisibleIndex < index) {\n          this._renderSeparator($nodeContainer);\n        }\n        this._renderItem(index, node, $nodeContainer);\n      });\n      if (!this.hasIcons) {\n        $nodeContainer.addClass(DX_MENU_NO_ICONS_CLASS);\n      }\n    }\n  }\n  _renderContainer($wrapper) {\n    var $container = $(\"<ul>\");\n    this.setAria(\"role\", \"none\", $container);\n    return $container.appendTo($wrapper).addClass(DX_MENU_ITEMS_CONTAINER_CLASS);\n  }\n  _createDOMElement($nodeContainer) {\n    var $node = $(\"<li>\");\n    this.setAria(\"role\", \"none\", $node);\n    return $node.appendTo($nodeContainer).addClass(DX_MENU_ITEM_WRAPPER_CLASS);\n  }\n  _renderItem(index, node, $nodeContainer, $nodeElement) {\n    var items = this.option(\"items\");\n    var $node = $nodeElement || this._createDOMElement($nodeContainer);\n    if (items[index + 1] && items[index + 1].beginGroup) {\n      $node.addClass(DX_MENU_ITEM_LAST_GROUP_ITEM);\n    }\n    var $itemFrame = super._renderItem(index, node.internalFields.item, $node);\n    if (node.internalFields.item === this.option(\"selectedItem\")) {\n      $itemFrame.addClass(DX_MENU_SELECTED_ITEM_CLASS);\n    }\n    $itemFrame.attr(\"tabIndex\", -1);\n    if (this._hasSubmenu(node)) {\n      this.setAria(\"haspopup\", \"true\", $itemFrame);\n    }\n  }\n  _renderItemFrame(index, itemData, $itemContainer) {\n    var $itemFrame = $itemContainer.children(\".\".concat(ITEM_CLASS));\n    return $itemFrame.length ? $itemFrame : super._renderItemFrame.apply(this, arguments);\n  }\n  _refreshItem($item, item) {\n    var node = this._dataAdapter.getNodeByItem(item);\n    var index = $item.data(this._itemIndexKey());\n    var $nodeContainer = $item.closest(\"ul\");\n    var $nodeElement = $item.closest(\"li\");\n    this._renderItem(index, node, $nodeContainer, $nodeElement);\n  }\n  _addContentClasses(itemData, $itemFrame) {\n    var hasText = itemData.text ? !!itemData.text.length : false;\n    var hasIcon = !!itemData.icon;\n    var hasSubmenu = itemData.items ? !!itemData.items.length : false;\n    $itemFrame.toggleClass(DX_ITEM_HAS_TEXT, hasText);\n    $itemFrame.toggleClass(DX_ITEM_HAS_ICON, hasIcon);\n    if (!this.hasIcons) {\n      this.hasIcons = hasIcon;\n    }\n    $itemFrame.toggleClass(DX_ITEM_HAS_SUBMENU, hasSubmenu);\n  }\n  _getItemContent($itemFrame) {\n    var $itemContent = super._getItemContent($itemFrame);\n    if (!$itemContent.length) {\n      $itemContent = $itemFrame.children(\".\".concat(DX_ITEM_CONTENT_CLASS));\n    }\n    return $itemContent;\n  }\n  _postprocessRenderItem(args) {\n    var $itemElement = $(args.itemElement);\n    var selectedIndex = this._dataAdapter.getSelectedNodesKeys();\n    if (!selectedIndex.length || !this._selectedGetter(args.itemData) || !this._isItemSelectable(args.itemData)) {\n      this._setAriaSelected($itemElement, \"false\");\n      return;\n    }\n    var node = this._dataAdapter.getNodeByItem(args.itemData);\n    if (node.internalFields.key === selectedIndex[0]) {\n      $itemElement.addClass(this._selectedItemClass());\n      this._setAriaSelected($itemElement, \"true\");\n    } else {\n      this._setAriaSelected($itemElement, \"false\");\n    }\n  }\n  _isItemSelectable(item) {\n    return false !== item.selectable;\n  }\n  _renderSeparator($itemsContainer) {\n    $(\"<li>\").appendTo($itemsContainer).addClass(DX_MENU_SEPARATOR_CLASS);\n  }\n  _itemClickHandler(e) {\n    if (e._skipHandling) {\n      return;\n    }\n    var itemClickActionHandler = this._createAction(this._updateSubmenuVisibilityOnClick.bind(this));\n    this._itemDXEventHandler(e, \"onItemClick\", {}, {\n      afterExecute: itemClickActionHandler.bind(this)\n    });\n    e._skipHandling = true;\n  }\n  _updateSubmenuVisibilityOnClick(actionArgs) {\n    this._updateSelectedItemOnClick(actionArgs);\n    if (\"onClick\" === this._getShowSubmenuMode()) {\n      this._addExpandedClass(actionArgs.args[0].itemElement);\n    }\n  }\n  _updateSelectedItemOnClick(actionArgs) {\n    var args = actionArgs.args ? actionArgs.args[0] : actionArgs;\n    if (!this._isItemSelectionAllowed(args.itemData)) {\n      return;\n    }\n    var selectedItemKey = this._dataAdapter.getSelectedNodesKeys();\n    var selectedNode = selectedItemKey.length && this._dataAdapter.getNodeByKey(selectedItemKey[0]);\n    if (selectedNode) {\n      this._toggleItemSelection(selectedNode, false);\n    }\n    if (!selectedNode || selectedNode.internalFields.item !== args.itemData) {\n      this.selectItem(args.itemData);\n    } else {\n      this._fireSelectionChangeEvent(null, this.option(\"selectedItem\"));\n      this._setOptionWithoutOptionChange(\"selectedItem\", null);\n    }\n  }\n  _isItemSelectionAllowed(item) {\n    var isSelectionByClickEnabled = this._isSelectionEnabled() && this.option(\"selectByClick\");\n    return !this._isContainerEmpty() && isSelectionByClickEnabled && this._isItemSelectable(item) && !this._itemsGetter(item);\n  }\n  _isContainerEmpty() {\n    return this._itemContainer().is(\":empty\");\n  }\n  _syncSelectionOptions() {\n    return asyncNoop();\n  }\n  _optionChanged(args) {\n    switch (args.name) {\n      case \"showSubmenuMode\":\n        break;\n      case \"selectedItem\":\n        var node = this._dataAdapter.getNodeByItem(args.value);\n        var selectedKey = this._dataAdapter.getSelectedNodesKeys()[0];\n        if (node && node.internalFields.key !== selectedKey) {\n          if (false === node.selectable) {\n            break;\n          }\n          if (selectedKey) {\n            this._toggleItemSelection(this._dataAdapter.getNodeByKey(selectedKey), false);\n          }\n          this._toggleItemSelection(node, true);\n          this._updateSelectedItems();\n        }\n        break;\n      case \"cssClass\":\n      case \"position\":\n      case \"selectByClick\":\n      case \"animation\":\n      case \"useInkRipple\":\n        this._invalidate();\n        break;\n      default:\n        super._optionChanged(args);\n    }\n  }\n  _toggleItemSelection(node, value) {\n    var itemElement = this._getElementByItem(node.internalFields.item);\n    itemElement && $(itemElement).toggleClass(DX_MENU_SELECTED_ITEM_CLASS);\n    this._dataAdapter.toggleSelection(node.internalFields.key, value);\n  }\n  _getElementByItem(itemData) {\n    var result;\n    each(this._itemElements(), (_, itemElement) => {\n      if ($(itemElement).data(this._itemDataKey()) !== itemData) {\n        return true;\n      }\n      result = itemElement;\n      return false;\n    });\n    return result;\n  }\n  _updateSelectedItems(oldSelection, newSelection) {\n    if (oldSelection || newSelection) {\n      this._fireSelectionChangeEvent(newSelection, oldSelection);\n    }\n  }\n  _fireSelectionChangeEvent(addedSelection, removedSelection) {\n    this._createActionByOption(\"onSelectionChanged\", {\n      excludeValidators: [\"disabled\", \"readOnly\"]\n    })({\n      addedItems: [addedSelection],\n      removedItems: [removedSelection]\n    });\n  }\n  selectItem(itemElement) {\n    var itemData = itemElement.nodeType ? this._getItemData(itemElement) : itemElement;\n    var selectedKey = this._dataAdapter.getSelectedNodesKeys()[0];\n    var selectedItem = this.option(\"selectedItem\");\n    var node = this._dataAdapter.getNodeByItem(itemData);\n    if (node.internalFields.key !== selectedKey) {\n      if (selectedKey) {\n        this._toggleItemSelection(this._dataAdapter.getNodeByKey(selectedKey), false);\n      }\n      this._toggleItemSelection(node, true);\n      this._updateSelectedItems(selectedItem, itemData);\n      this._setOptionWithoutOptionChange(\"selectedItem\", itemData);\n    }\n  }\n  unselectItem(itemElement) {\n    var itemData = itemElement.nodeType ? this._getItemData(itemElement) : itemElement;\n    var node = this._dataAdapter.getNodeByItem(itemData);\n    var selectedItem = this.option(\"selectedItem\");\n    if (node.internalFields.selected) {\n      this._toggleItemSelection(node, false);\n      this._updateSelectedItems(selectedItem, null);\n      this._setOptionWithoutOptionChange(\"selectedItem\", null);\n    }\n  }\n}\nMenuBase.ItemClass = MenuItem;\nexport default MenuBase;","map":{"version":3,"names":["$","noop","asyncNoop","isPlainObject","isObject","isDefined","each","extend","render","HierarchicalCollectionWidget","MenuBaseEditStrategy","devices","MenuItem","DX_MENU_CLASS","DX_MENU_NO_ICONS_CLASS","DX_MENU_BASE_CLASS","ITEM_CLASS","DX_ITEM_CONTENT_CLASS","DX_MENU_SELECTED_ITEM_CLASS","DX_MENU_ITEM_WRAPPER_CLASS","DX_MENU_ITEMS_CONTAINER_CLASS","DX_MENU_ITEM_EXPANDED_CLASS","DX_MENU_SEPARATOR_CLASS","DX_MENU_ITEM_LAST_GROUP_ITEM","DX_ITEM_HAS_TEXT","DX_ITEM_HAS_ICON","DX_ITEM_HAS_SUBMENU","DX_MENU_ITEM_POPOUT_CLASS","DX_MENU_ITEM_POPOUT_CONTAINER_CLASS","DX_MENU_ITEM_CAPTION_CLASS","SINGLE_SELECTION_MODE","DEFAULT_DELAY","show","hide","MenuBase","_getDefaultOptions","items","cssClass","activeStateEnabled","showSubmenuMode","name","delay","animation","type","from","to","duration","selectByClick","focusOnSelectedItem","keyExpr","_itemAttributes","role","useInkRipple","_itemDataKey","_itemClass","_setAriaSelected","_selectedItemClass","_widgetClass","_focusTarget","_itemContainer","_clean","option","_supportedKeys","space","$item","length","_isSelectionEnabled","selectItem","pageUp","pageDown","_init","_activeStateUnit","concat","_renderSelectedItem","_initActions","_getTextContainer","itemData","itemText","text","$itemContainer","addClass","itemContent","String","_getPopoutContainer","$popOutContainer","$popOutImage","append","_getDataAdapterOptions","rootValue","multipleSelection","recursiveSelection","recursiveExpansion","searchValue","_selectByItem","selectedItem","nodeToSelect","_dataAdapter","getNodeByItem","toggleSelection","internalFields","key","selectedKeys","getSelectedNodesKeys","selectedKey","node","getNodeByKey","selectable","item","_initMarkup","_renderInkRipple","_inkRipple","_toggleActiveState","$element","value","e","apply","arguments","config","element","event","showWave","hideWave","_getShowSubmenuMode","optionValue","_isDesktopDevice","_initSelectedItems","real","deviceType","_initEditStrategy","Strategy","_editStrategy","_addCustomCssClass","_itemWrapperSelector","_hoverStartHandler","$itemElement","_getItemElementByEventArgs","_isItemDisabled","stopPropagation","clearTimeout","_showSubmenusTimeout","setTimeout","_showSubmenu","bind","_getSubmenuDelay","_getAvailableItems","$itemElements","filter","css","_disabledGetter","data","_addExpandedClass","itemElement","action","eventArgs","$target","target","hasClass","get","currentTarget","parent","_hoverEndHandler","_hasSubmenu","childrenKeys","_renderContentImpl","_renderItems","getRootNodes","nodes","submenuContainer","hasIcons","$nodeContainer","_renderContainer","firstVisibleIndex","nextGroupFirstIndex","index","isVisibleNode","visible","isBeginGroup","beginGroup","_renderSeparator","_renderItem","$wrapper","$container","setAria","appendTo","_createDOMElement","$node","$nodeElement","$itemFrame","attr","_renderItemFrame","children","_refreshItem","_itemIndexKey","closest","_addContentClasses","hasText","hasIcon","icon","hasSubmenu","toggleClass","_getItemContent","$itemContent","_postprocessRenderItem","args","selectedIndex","_selectedGetter","_isItemSelectable","$itemsContainer","_itemClickHandler","_skipHandling","itemClickActionHandler","_createAction","_updateSubmenuVisibilityOnClick","_itemDXEventHandler","afterExecute","actionArgs","_updateSelectedItemOnClick","_isItemSelectionAllowed","selectedItemKey","selectedNode","_toggleItemSelection","_fireSelectionChangeEvent","_setOptionWithoutOptionChange","isSelectionByClickEnabled","_isContainerEmpty","_itemsGetter","is","_syncSelectionOptions","_optionChanged","_updateSelectedItems","_invalidate","_getElementByItem","result","_itemElements","_","oldSelection","newSelection","addedSelection","removedSelection","_createActionByOption","excludeValidators","addedItems","removedItems","nodeType","_getItemData","unselectItem","selected","ItemClass"],"sources":["C:/Users/ninad/OneDrive/Radna površina/zavrsni/client/node_modules/devextreme/esm/ui/context_menu/ui.menu_base.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/ui/context_menu/ui.menu_base.js)\r\n * Version: 22.2.6\r\n * Build date: Tue Apr 18 2023\r\n *\r\n * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport $ from \"../../core/renderer\";\r\nimport {\r\n    noop,\r\n    asyncNoop\r\n} from \"../../core/utils/common\";\r\nimport {\r\n    isPlainObject,\r\n    isObject,\r\n    isDefined\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    each\r\n} from \"../../core/utils/iterator\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    render\r\n} from \"../widget/utils.ink_ripple\";\r\nimport HierarchicalCollectionWidget from \"../hierarchical_collection/ui.hierarchical_collection_widget\";\r\nimport MenuBaseEditStrategy from \"./ui.menu_base.edit.strategy\";\r\nimport devices from \"../../core/devices\";\r\nimport MenuItem from \"../collection/item\";\r\nvar DX_MENU_CLASS = \"dx-menu\";\r\nvar DX_MENU_NO_ICONS_CLASS = DX_MENU_CLASS + \"-no-icons\";\r\nvar DX_MENU_BASE_CLASS = \"dx-menu-base\";\r\nvar ITEM_CLASS = DX_MENU_CLASS + \"-item\";\r\nvar DX_ITEM_CONTENT_CLASS = ITEM_CLASS + \"-content\";\r\nvar DX_MENU_SELECTED_ITEM_CLASS = ITEM_CLASS + \"-selected\";\r\nvar DX_MENU_ITEM_WRAPPER_CLASS = ITEM_CLASS + \"-wrapper\";\r\nvar DX_MENU_ITEMS_CONTAINER_CLASS = DX_MENU_CLASS + \"-items-container\";\r\nvar DX_MENU_ITEM_EXPANDED_CLASS = ITEM_CLASS + \"-expanded\";\r\nvar DX_MENU_SEPARATOR_CLASS = DX_MENU_CLASS + \"-separator\";\r\nvar DX_MENU_ITEM_LAST_GROUP_ITEM = DX_MENU_CLASS + \"-last-group-item\";\r\nvar DX_ITEM_HAS_TEXT = ITEM_CLASS + \"-has-text\";\r\nvar DX_ITEM_HAS_ICON = ITEM_CLASS + \"-has-icon\";\r\nvar DX_ITEM_HAS_SUBMENU = ITEM_CLASS + \"-has-submenu\";\r\nvar DX_MENU_ITEM_POPOUT_CLASS = ITEM_CLASS + \"-popout\";\r\nvar DX_MENU_ITEM_POPOUT_CONTAINER_CLASS = DX_MENU_ITEM_POPOUT_CLASS + \"-container\";\r\nvar DX_MENU_ITEM_CAPTION_CLASS = ITEM_CLASS + \"-text\";\r\nvar SINGLE_SELECTION_MODE = \"single\";\r\nvar DEFAULT_DELAY = {\r\n    show: 50,\r\n    hide: 300\r\n};\r\nclass MenuBase extends HierarchicalCollectionWidget {\r\n    _getDefaultOptions() {\r\n        return extend(super._getDefaultOptions(), {\r\n            items: [],\r\n            cssClass: \"\",\r\n            activeStateEnabled: true,\r\n            showSubmenuMode: {\r\n                name: \"onHover\",\r\n                delay: {\r\n                    show: 50,\r\n                    hide: 300\r\n                }\r\n            },\r\n            animation: {\r\n                show: {\r\n                    type: \"fade\",\r\n                    from: 0,\r\n                    to: 1,\r\n                    duration: 100\r\n                },\r\n                hide: {\r\n                    type: \"fade\",\r\n                    from: 1,\r\n                    to: 0,\r\n                    duration: 100\r\n                }\r\n            },\r\n            selectByClick: false,\r\n            focusOnSelectedItem: false,\r\n            keyExpr: null,\r\n            _itemAttributes: {\r\n                role: \"menuitem\"\r\n            },\r\n            useInkRipple: false\r\n        })\r\n    }\r\n    _itemDataKey() {\r\n        return \"dxMenuItemDataKey\"\r\n    }\r\n    _itemClass() {\r\n        return ITEM_CLASS\r\n    }\r\n    _setAriaSelected() {}\r\n    _selectedItemClass() {\r\n        return DX_MENU_SELECTED_ITEM_CLASS\r\n    }\r\n    _widgetClass() {\r\n        return DX_MENU_BASE_CLASS\r\n    }\r\n    _focusTarget() {\r\n        return this._itemContainer()\r\n    }\r\n    _clean() {\r\n        this.option(\"focusedElement\", null);\r\n        super._clean()\r\n    }\r\n    _supportedKeys() {\r\n        return extend(super._supportedKeys(), {\r\n            space: () => {\r\n                var $item = $(this.option(\"focusedElement\"));\r\n                if (!$item.length || !this._isSelectionEnabled()) {\r\n                    return\r\n                }\r\n                this.selectItem($item[0])\r\n            },\r\n            pageUp: noop,\r\n            pageDown: noop\r\n        })\r\n    }\r\n    _isSelectionEnabled() {\r\n        return this.option(\"selectionMode\") === SINGLE_SELECTION_MODE\r\n    }\r\n    _init() {\r\n        this._activeStateUnit = \".\".concat(ITEM_CLASS);\r\n        super._init();\r\n        this._renderSelectedItem();\r\n        this._initActions()\r\n    }\r\n    _getTextContainer(itemData) {\r\n        var itemText = itemData.text;\r\n        var $itemContainer = $(\"<span>\").addClass(DX_MENU_ITEM_CAPTION_CLASS);\r\n        var itemContent = isPlainObject(itemData) ? itemText : String(itemData);\r\n        return itemText && $itemContainer.text(itemContent)\r\n    }\r\n    _getPopoutContainer(itemData) {\r\n        var items = itemData.items;\r\n        var $popOutContainer;\r\n        if (items && items.length) {\r\n            var $popOutImage = $(\"<div>\").addClass(DX_MENU_ITEM_POPOUT_CLASS);\r\n            $popOutContainer = $(\"<span>\").addClass(DX_MENU_ITEM_POPOUT_CONTAINER_CLASS).append($popOutImage)\r\n        }\r\n        return $popOutContainer\r\n    }\r\n    _getDataAdapterOptions() {\r\n        return {\r\n            rootValue: 0,\r\n            multipleSelection: false,\r\n            recursiveSelection: false,\r\n            recursiveExpansion: false,\r\n            searchValue: \"\"\r\n        }\r\n    }\r\n    _selectByItem(selectedItem) {\r\n        if (!selectedItem) {\r\n            return\r\n        }\r\n        var nodeToSelect = this._dataAdapter.getNodeByItem(selectedItem);\r\n        this._dataAdapter.toggleSelection(nodeToSelect.internalFields.key, true)\r\n    }\r\n    _renderSelectedItem() {\r\n        var selectedKeys = this._dataAdapter.getSelectedNodesKeys();\r\n        var selectedKey = selectedKeys.length && selectedKeys[0];\r\n        var selectedItem = this.option(\"selectedItem\");\r\n        if (!selectedKey) {\r\n            this._selectByItem(selectedItem);\r\n            return\r\n        }\r\n        var node = this._dataAdapter.getNodeByKey(selectedKey);\r\n        if (false === node.selectable) {\r\n            return\r\n        }\r\n        if (!selectedItem) {\r\n            this.option(\"selectedItem\", node.internalFields.item);\r\n            return\r\n        }\r\n        if (selectedItem !== node.internalFields.item) {\r\n            this._dataAdapter.toggleSelection(selectedKey, false);\r\n            this._selectByItem(selectedItem)\r\n        }\r\n    }\r\n    _initActions() {}\r\n    _initMarkup() {\r\n        super._initMarkup();\r\n        this.option(\"useInkRipple\") && this._renderInkRipple()\r\n    }\r\n    _renderInkRipple() {\r\n        this._inkRipple = render()\r\n    }\r\n    _toggleActiveState($element, value, e) {\r\n        super._toggleActiveState.apply(this, arguments);\r\n        if (!this._inkRipple) {\r\n            return\r\n        }\r\n        var config = {\r\n            element: $element,\r\n            event: e\r\n        };\r\n        if (value) {\r\n            this._inkRipple.showWave(config)\r\n        } else {\r\n            this._inkRipple.hideWave(config)\r\n        }\r\n    }\r\n    _getShowSubmenuMode() {\r\n        var optionValue = this.option(\"showSubmenuMode\");\r\n        optionValue = isObject(optionValue) ? optionValue.name : optionValue;\r\n        return this._isDesktopDevice() ? optionValue : \"onClick\"\r\n    }\r\n    _initSelectedItems() {}\r\n    _isDesktopDevice() {\r\n        return \"desktop\" === devices.real().deviceType\r\n    }\r\n    _initEditStrategy() {\r\n        var Strategy = MenuBaseEditStrategy;\r\n        this._editStrategy = new Strategy(this)\r\n    }\r\n    _addCustomCssClass($element) {\r\n        $element.addClass(this.option(\"cssClass\"))\r\n    }\r\n    _itemWrapperSelector() {\r\n        return \".\".concat(DX_MENU_ITEM_WRAPPER_CLASS)\r\n    }\r\n    _hoverStartHandler(e) {\r\n        var $itemElement = this._getItemElementByEventArgs(e);\r\n        if (!$itemElement || this._isItemDisabled($itemElement)) {\r\n            return\r\n        }\r\n        e.stopPropagation();\r\n        if (\"onHover\" === this._getShowSubmenuMode()) {\r\n            clearTimeout(this._showSubmenusTimeout);\r\n            this._showSubmenusTimeout = setTimeout(this._showSubmenu.bind(this, $itemElement), this._getSubmenuDelay(\"show\"))\r\n        }\r\n    }\r\n    _getAvailableItems($itemElements) {\r\n        return super._getAvailableItems($itemElements).filter((function() {\r\n            return \"hidden\" !== $(this).css(\"visibility\")\r\n        }))\r\n    }\r\n    _isItemDisabled($item) {\r\n        return this._disabledGetter($item.data(this._itemDataKey()))\r\n    }\r\n    _showSubmenu($itemElement) {\r\n        this._addExpandedClass($itemElement)\r\n    }\r\n    _addExpandedClass(itemElement) {\r\n        $(itemElement).addClass(DX_MENU_ITEM_EXPANDED_CLASS)\r\n    }\r\n    _getSubmenuDelay(action) {\r\n        var {\r\n            delay: delay\r\n        } = this.option(\"showSubmenuMode\");\r\n        if (!isDefined(delay)) {\r\n            return DEFAULT_DELAY[action]\r\n        }\r\n        return isObject(delay) ? delay[action] : delay\r\n    }\r\n    _getItemElementByEventArgs(eventArgs) {\r\n        var $target = $(eventArgs.target);\r\n        if ($target.hasClass(this._itemClass()) || $target.get(0) === eventArgs.currentTarget) {\r\n            return $target\r\n        }\r\n        while (!$target.hasClass(this._itemClass())) {\r\n            $target = $target.parent();\r\n            if ($target.hasClass(\"dx-submenu\")) {\r\n                return null\r\n            }\r\n        }\r\n        return $target\r\n    }\r\n    _hoverEndHandler() {\r\n        clearTimeout(this._showSubmenusTimeout)\r\n    }\r\n    _hasSubmenu(node) {\r\n        return node && node.internalFields.childrenKeys.length\r\n    }\r\n    _renderContentImpl() {\r\n        this._renderItems(this._dataAdapter.getRootNodes())\r\n    }\r\n    _renderItems(nodes, submenuContainer) {\r\n        if (nodes.length) {\r\n            this.hasIcons = false;\r\n            var $nodeContainer = this._renderContainer(this.$element(), submenuContainer);\r\n            var firstVisibleIndex = -1;\r\n            var nextGroupFirstIndex = -1;\r\n            each(nodes, (index, node) => {\r\n                var isVisibleNode = false !== node.visible;\r\n                if (isVisibleNode && firstVisibleIndex < 0) {\r\n                    firstVisibleIndex = index\r\n                }\r\n                var isBeginGroup = firstVisibleIndex < index && (node.beginGroup || index === nextGroupFirstIndex);\r\n                if (isBeginGroup) {\r\n                    nextGroupFirstIndex = isVisibleNode ? index : index + 1\r\n                }\r\n                if (index === nextGroupFirstIndex && firstVisibleIndex < index) {\r\n                    this._renderSeparator($nodeContainer)\r\n                }\r\n                this._renderItem(index, node, $nodeContainer)\r\n            });\r\n            if (!this.hasIcons) {\r\n                $nodeContainer.addClass(DX_MENU_NO_ICONS_CLASS)\r\n            }\r\n        }\r\n    }\r\n    _renderContainer($wrapper) {\r\n        var $container = $(\"<ul>\");\r\n        this.setAria(\"role\", \"none\", $container);\r\n        return $container.appendTo($wrapper).addClass(DX_MENU_ITEMS_CONTAINER_CLASS)\r\n    }\r\n    _createDOMElement($nodeContainer) {\r\n        var $node = $(\"<li>\");\r\n        this.setAria(\"role\", \"none\", $node);\r\n        return $node.appendTo($nodeContainer).addClass(DX_MENU_ITEM_WRAPPER_CLASS)\r\n    }\r\n    _renderItem(index, node, $nodeContainer, $nodeElement) {\r\n        var items = this.option(\"items\");\r\n        var $node = $nodeElement || this._createDOMElement($nodeContainer);\r\n        if (items[index + 1] && items[index + 1].beginGroup) {\r\n            $node.addClass(DX_MENU_ITEM_LAST_GROUP_ITEM)\r\n        }\r\n        var $itemFrame = super._renderItem(index, node.internalFields.item, $node);\r\n        if (node.internalFields.item === this.option(\"selectedItem\")) {\r\n            $itemFrame.addClass(DX_MENU_SELECTED_ITEM_CLASS)\r\n        }\r\n        $itemFrame.attr(\"tabIndex\", -1);\r\n        if (this._hasSubmenu(node)) {\r\n            this.setAria(\"haspopup\", \"true\", $itemFrame)\r\n        }\r\n    }\r\n    _renderItemFrame(index, itemData, $itemContainer) {\r\n        var $itemFrame = $itemContainer.children(\".\".concat(ITEM_CLASS));\r\n        return $itemFrame.length ? $itemFrame : super._renderItemFrame.apply(this, arguments)\r\n    }\r\n    _refreshItem($item, item) {\r\n        var node = this._dataAdapter.getNodeByItem(item);\r\n        var index = $item.data(this._itemIndexKey());\r\n        var $nodeContainer = $item.closest(\"ul\");\r\n        var $nodeElement = $item.closest(\"li\");\r\n        this._renderItem(index, node, $nodeContainer, $nodeElement)\r\n    }\r\n    _addContentClasses(itemData, $itemFrame) {\r\n        var hasText = itemData.text ? !!itemData.text.length : false;\r\n        var hasIcon = !!itemData.icon;\r\n        var hasSubmenu = itemData.items ? !!itemData.items.length : false;\r\n        $itemFrame.toggleClass(DX_ITEM_HAS_TEXT, hasText);\r\n        $itemFrame.toggleClass(DX_ITEM_HAS_ICON, hasIcon);\r\n        if (!this.hasIcons) {\r\n            this.hasIcons = hasIcon\r\n        }\r\n        $itemFrame.toggleClass(DX_ITEM_HAS_SUBMENU, hasSubmenu)\r\n    }\r\n    _getItemContent($itemFrame) {\r\n        var $itemContent = super._getItemContent($itemFrame);\r\n        if (!$itemContent.length) {\r\n            $itemContent = $itemFrame.children(\".\".concat(DX_ITEM_CONTENT_CLASS))\r\n        }\r\n        return $itemContent\r\n    }\r\n    _postprocessRenderItem(args) {\r\n        var $itemElement = $(args.itemElement);\r\n        var selectedIndex = this._dataAdapter.getSelectedNodesKeys();\r\n        if (!selectedIndex.length || !this._selectedGetter(args.itemData) || !this._isItemSelectable(args.itemData)) {\r\n            this._setAriaSelected($itemElement, \"false\");\r\n            return\r\n        }\r\n        var node = this._dataAdapter.getNodeByItem(args.itemData);\r\n        if (node.internalFields.key === selectedIndex[0]) {\r\n            $itemElement.addClass(this._selectedItemClass());\r\n            this._setAriaSelected($itemElement, \"true\")\r\n        } else {\r\n            this._setAriaSelected($itemElement, \"false\")\r\n        }\r\n    }\r\n    _isItemSelectable(item) {\r\n        return false !== item.selectable\r\n    }\r\n    _renderSeparator($itemsContainer) {\r\n        $(\"<li>\").appendTo($itemsContainer).addClass(DX_MENU_SEPARATOR_CLASS)\r\n    }\r\n    _itemClickHandler(e) {\r\n        if (e._skipHandling) {\r\n            return\r\n        }\r\n        var itemClickActionHandler = this._createAction(this._updateSubmenuVisibilityOnClick.bind(this));\r\n        this._itemDXEventHandler(e, \"onItemClick\", {}, {\r\n            afterExecute: itemClickActionHandler.bind(this)\r\n        });\r\n        e._skipHandling = true\r\n    }\r\n    _updateSubmenuVisibilityOnClick(actionArgs) {\r\n        this._updateSelectedItemOnClick(actionArgs);\r\n        if (\"onClick\" === this._getShowSubmenuMode()) {\r\n            this._addExpandedClass(actionArgs.args[0].itemElement)\r\n        }\r\n    }\r\n    _updateSelectedItemOnClick(actionArgs) {\r\n        var args = actionArgs.args ? actionArgs.args[0] : actionArgs;\r\n        if (!this._isItemSelectionAllowed(args.itemData)) {\r\n            return\r\n        }\r\n        var selectedItemKey = this._dataAdapter.getSelectedNodesKeys();\r\n        var selectedNode = selectedItemKey.length && this._dataAdapter.getNodeByKey(selectedItemKey[0]);\r\n        if (selectedNode) {\r\n            this._toggleItemSelection(selectedNode, false)\r\n        }\r\n        if (!selectedNode || selectedNode.internalFields.item !== args.itemData) {\r\n            this.selectItem(args.itemData)\r\n        } else {\r\n            this._fireSelectionChangeEvent(null, this.option(\"selectedItem\"));\r\n            this._setOptionWithoutOptionChange(\"selectedItem\", null)\r\n        }\r\n    }\r\n    _isItemSelectionAllowed(item) {\r\n        var isSelectionByClickEnabled = this._isSelectionEnabled() && this.option(\"selectByClick\");\r\n        return !this._isContainerEmpty() && isSelectionByClickEnabled && this._isItemSelectable(item) && !this._itemsGetter(item)\r\n    }\r\n    _isContainerEmpty() {\r\n        return this._itemContainer().is(\":empty\")\r\n    }\r\n    _syncSelectionOptions() {\r\n        return asyncNoop()\r\n    }\r\n    _optionChanged(args) {\r\n        switch (args.name) {\r\n            case \"showSubmenuMode\":\r\n                break;\r\n            case \"selectedItem\":\r\n                var node = this._dataAdapter.getNodeByItem(args.value);\r\n                var selectedKey = this._dataAdapter.getSelectedNodesKeys()[0];\r\n                if (node && node.internalFields.key !== selectedKey) {\r\n                    if (false === node.selectable) {\r\n                        break\r\n                    }\r\n                    if (selectedKey) {\r\n                        this._toggleItemSelection(this._dataAdapter.getNodeByKey(selectedKey), false)\r\n                    }\r\n                    this._toggleItemSelection(node, true);\r\n                    this._updateSelectedItems()\r\n                }\r\n                break;\r\n            case \"cssClass\":\r\n            case \"position\":\r\n            case \"selectByClick\":\r\n            case \"animation\":\r\n            case \"useInkRipple\":\r\n                this._invalidate();\r\n                break;\r\n            default:\r\n                super._optionChanged(args)\r\n        }\r\n    }\r\n    _toggleItemSelection(node, value) {\r\n        var itemElement = this._getElementByItem(node.internalFields.item);\r\n        itemElement && $(itemElement).toggleClass(DX_MENU_SELECTED_ITEM_CLASS);\r\n        this._dataAdapter.toggleSelection(node.internalFields.key, value)\r\n    }\r\n    _getElementByItem(itemData) {\r\n        var result;\r\n        each(this._itemElements(), (_, itemElement) => {\r\n            if ($(itemElement).data(this._itemDataKey()) !== itemData) {\r\n                return true\r\n            }\r\n            result = itemElement;\r\n            return false\r\n        });\r\n        return result\r\n    }\r\n    _updateSelectedItems(oldSelection, newSelection) {\r\n        if (oldSelection || newSelection) {\r\n            this._fireSelectionChangeEvent(newSelection, oldSelection)\r\n        }\r\n    }\r\n    _fireSelectionChangeEvent(addedSelection, removedSelection) {\r\n        this._createActionByOption(\"onSelectionChanged\", {\r\n            excludeValidators: [\"disabled\", \"readOnly\"]\r\n        })({\r\n            addedItems: [addedSelection],\r\n            removedItems: [removedSelection]\r\n        })\r\n    }\r\n    selectItem(itemElement) {\r\n        var itemData = itemElement.nodeType ? this._getItemData(itemElement) : itemElement;\r\n        var selectedKey = this._dataAdapter.getSelectedNodesKeys()[0];\r\n        var selectedItem = this.option(\"selectedItem\");\r\n        var node = this._dataAdapter.getNodeByItem(itemData);\r\n        if (node.internalFields.key !== selectedKey) {\r\n            if (selectedKey) {\r\n                this._toggleItemSelection(this._dataAdapter.getNodeByKey(selectedKey), false)\r\n            }\r\n            this._toggleItemSelection(node, true);\r\n            this._updateSelectedItems(selectedItem, itemData);\r\n            this._setOptionWithoutOptionChange(\"selectedItem\", itemData)\r\n        }\r\n    }\r\n    unselectItem(itemElement) {\r\n        var itemData = itemElement.nodeType ? this._getItemData(itemElement) : itemElement;\r\n        var node = this._dataAdapter.getNodeByItem(itemData);\r\n        var selectedItem = this.option(\"selectedItem\");\r\n        if (node.internalFields.selected) {\r\n            this._toggleItemSelection(node, false);\r\n            this._updateSelectedItems(selectedItem, null);\r\n            this._setOptionWithoutOptionChange(\"selectedItem\", null)\r\n        }\r\n    }\r\n}\r\nMenuBase.ItemClass = MenuItem;\r\nexport default MenuBase;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}